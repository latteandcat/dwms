<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta charset="utf-8" />
<title>欢迎进入神农连锁药品仓库管理系统</title>
<meta name="description" content="overview &amp; stats" />
<meta name="viewport"
	content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />

<!-- 引用css -->
		<link rel="stylesheet" href="../plugins/time_picker/lyz.calendar.css" />
		<link rel="stylesheet" href="../plugins/ace/assets/css/chosen.css" />
		<link rel="stylesheet" href="../plugins/ace/assets/css/datepicker.css" />
		<link rel="stylesheet" href="../plugins/ace/assets/css/bootstrap-timepicker.css" />
		<link rel="stylesheet" href="../plugins/ace/assets/css/daterangepicker.css" />
		<link rel="stylesheet" href="../plugins/ace/assets/css/bootstrap-datetimepicker.css" />
<!-- 引用结束 -->
<!-- 引用js -->
		<script src="../plugins/time_picker/lyz.calendar.min.js" type="text/javascript"></script>
<!-- 引用结束 -->
<!-- bootstrap & fontawesome -->
<link rel="stylesheet" href="../plugins/ace/assets/css/bootstrap.css" />
<link rel="stylesheet" href="../plugins/ace/assets/css/font-awesome.css" />
<link rel="stylesheet" href="../plugins/ace/assets/css/jquery-ui.css" />
<link rel="stylesheet" href="../plugins/ace/assets/css/bootstrap-timepicker.css" />

<link rel="stylesheet" href="../plugins/ace/assets/css/bootstrap-datetimepicker.css" />
<link rel="stylesheet"
	href="../plugins/laypage-v1.3/laypage/skin/laypage.css" />

<link rel="stylesheet" href="../plugins/ace/assets/css/ui.jqgrid.css" />
<!--~~~~-->

<!-- page specific plugin styles -->
<!-- text fonts -->
<link rel="stylesheet" href="../plugins/ace/assets/css/ace-fonts.css" />

<!-- ace styles -->
<link rel="stylesheet" href="../plugins/ace/assets/css/ace.css"
	class="ace-main-stylesheet" id="main-ace-style" />

<link rel="stylesheet" href="../plugins/layer/skin/layer.css">
<link rel="stylesheet" href="../plugins/layer/skin/layer.ext.css">
<!-- //zTree_v3 -->
<link rel="stylesheet"
	href="../plugins/zTree_v3/css/metroStyle/metroStyle.css" type="text/css">
<link rel="stylesheet"
	href="../plugins/zTree_v3/css/zTreeStyle/zTreeStyle.css" type="text/css">
<style type="text/css">
.ztree li span.button.add {
	margin-left: 2px;
	margin-right: -1px;
	background-position: -144px 0;
	vertical-align: top;
	*vertical-align: middle
}
</style>

<!--[if lte IE 9]>
			<link rel="stylesheet" href="plugins/ace/assets/css/ace-part2.css" class="ace-main-stylesheet" />
		<![endif]-->

<!--[if lte IE 9]>
		  <link rel="stylesheet" href="plugins/ace/assets/css/ace-ie.css" />
		<![endif]-->

<!-- inline styles related to this page -->

<!-- ace settings handler -->
<script src="../plugins/ace/assets/js/ace-extra.js"></script>
<script src="../plugins/ace/assets/js/jquery1x.js"></script>

<script src="../plugins/laypage-v1.3/laypage/laypage.js"></script>
<script src="../plugins/echart/echarts-all.js" type="text/javascript"></script>
<!-- HTML5shiv and Respond.js for IE8 to support HTML5 elements and media queries -->
<!--[if lte IE 8]>
		<script src="plugins/ace/assets/js/html5shiv.js"></script>
		<script src="plugins/ace/assets/js/respond.js"></script>
		
		<![endif]-->
<style type="text/css">
.ztree span {
	font-size: 15px;
	height: 2em;
}

.ztree li {
	margin-top: 5px;
}
</style>
</head>

<body class="no-skin">
	<!-- #section:basics/navbar.layout -->
	<div id="navbar" class="navbar navbar-default">
		<script type="text/javascript">
			try {
				ace.settings.check('navbar', 'fixed')
			} catch (e) {
			}
		</script>

		<div class="navbar-container" id="navbar-container">
			<button type="button" class="navbar-toggle menu-toggler pull-left"
				id="menu-toggler" data-target="#sidebar">
				<span class="sr-only">Toggle sidebar</span> <span class="icon-bar"></span>
				<span class="icon-bar"></span> <span class="icon-bar"></span>
			</button>

			<!-- /section:basics/sidebar.mobile.toggle -->
			<div class="navbar-header pull-left">
				<!-- #section:basics/navbar.layout.brand -->
				<a href="/dwms/admin" class="navbar-brand"> <small> <i
						class="fa fa-key"></i> 神农连锁药品仓库管理系统 </small> </a>

				<!-- /section:basics/navbar.layout.brand -->

				<!-- #section:basics/navbar.toggle -->

				<!-- /section:basics/navbar.toggle -->
			</div>

			<!-- #section:basics/navbar.dropdown -->
			<div class="navbar-buttons navbar-header pull-right"
				role="navigation">
				<ul class="nav ace-nav">
					<!-- #section:basics/navbar.user_menu -->
					<li class="light-blue"><a data-toggle="dropdown" href="#"
						class="dropdown-toggle"> <img class="nav-user-photo"
							src="../plugins/ace/assets/avatars/user.jpg" alt="Jason's Photo" />
							<span class="user-info"> <small>欢迎您</small><small id="login_user"> 
							
							</small></span> <i 
								class="ace-icon fa fa-caret-down"></i> </a>
						<ul
							class="user-menu dropdown-menu-right dropdown-menu dropdown-yellow dropdown-caret dropdown-close">
							<li><a href="javascript:personInfo()"> <i
									class="ace-icon fa fa-user"></i> 查看个人资料 </a></li>
							<li><a href="javascript:updatePerson()"> <i
									class="ace-icon fa fa-cog"></i> 修改登录密码 </a></li>
							<li class="divider"></li>

							<li><a href="javascript:signout()" > <i
									class="ace-icon fa fa-power-off"></i> 退出 </a></li>
						</ul></li>

					<!-- /section:basics/navbar.user_menu -->
				</ul>
			</div>
			<!-- /section:basics/navbar.dropdown -->
		</div>
		<!-- /.navbar-container -->
	</div>
	<!-- /section:basics/navbar.layout -->
	<div class="main-container" id="main-container">
		<script type="text/javascript">
			try {
				ace.settings.check('main-container', 'fixed')
			} catch (e) {
			}
		</script>
		<div id="sidebar" class="sidebar responsive">
			<script type="text/javascript">
				try {
					ace.settings.check('sidebar', 'fixed')
				} catch (e) {
				}
			</script>

			<div class="sidebar-shortcuts" id="sidebar-shortcuts">
				<div class="sidebar-shortcuts-large" id="sidebar-shortcuts-large">
					<button class="btn btn-success" id="signout" title="注销">
						<i class="ace-icon fa fa-sign-out"></i>
					</button>

					<button class="btn btn-info" id="changePass" title="修改密码"
						onclick="updatePerson()">
						<i class="ace-icon fa fa-pencil-square-o "></i>
					</button>

					<!-- #section:basics/sidebar.layout.shortcuts -->
					<button class="btn btn-warning" id="console" title="首页">
						<i class="ace-icon fa fa-home"></i>
					</button>

					<button class="btn btn-danger" id="flush" title="刷新">
						<i class="ace-icon fa fa-refresh"></i>
					</button>

					<!-- /section:basics/sidebar.layout.shortcuts -->
				</div>

				<div class="sidebar-shortcuts-mini" id="sidebar-shortcuts-mini">
					<span class="btn btn-success"></span> <span class="btn btn-info"></span>

					<span class="btn btn-warning"></span> <span class="btn btn-danger"></span>
				</div>
			</div>
			<!-- /.sidebar-shortcuts -->

			<ul class="nav nav-list">
				<li ><a id="admin_main"> <i
						class="menu-icon fa fa-home"></i> <span class="menu-text">
							首页 </span>
				</a> <b class="arrow"></b></li>

				<li><a id="admin_drug"> <i class="menu-icon fa fa-list"></i>
						<span class="menu-text"> 药品管理 </span>
				</a> <b class="arrow"></b></li>
				<li class="active"><a id="admin_inventory"> <i
						class="menu-icon fa fa-tag"></i> <span class="menu-text">
							库存管理 </span>
				</a> <b class="arrow"></b></li>

				<li><a id="admin_supplier"> <i
						class="menu-icon fa fa-calendar"></i> <span class="menu-text">
							供应商管理 </span>
				</a> <b class="arrow"></b></li>
				
				<li><a id="admin_inout"> <i
						class="menu-icon fa fa-pencil-square-o"></i> <span class="menu-text">
							出入库 </span>
				</a> <b class="arrow"></b></li>
				
				<li><a id="admin_user"> <i
						class="menu-icon fa fa-list-alt"></i> <span class="menu-text">
							用户管理 </span>
				</a> <b class="arrow"></b></li>
				
				<li><a id="admin_log"> <i
						class="menu-icon fa fa-file-o"></i> <span class="menu-text">
							日志管理 </span>
				</a> <b class="arrow"></b></li>
			</ul>
			<!-- /.nav-list -->

			<!-- #section:basics/sidebar.layout.minimize -->
			<div class="sidebar-toggle sidebar-collapse" id="sidebar-collapse">
				<i class="ace-icon fa fa-angle-double-left"
					data-icon1="ace-icon fa fa-angle-double-left"
					data-icon2="ace-icon fa fa-angle-double-right"></i>
			</div>

			<!-- /section:basics/sidebar.layout.minimize -->
			<script type="text/javascript">
				try {
					ace.settings.check('sidebar', 'collapsed')
				} catch (e) {
				}
			</script>
		</div>
		<!-- /section:basics/sidebar -->
		<div class="main-content">
			<div id="main-content-inner">
				<!-- #section:basics/content.breadcrumbs -->
				<div class="breadcrumbs" id="breadcrumbs">
					<script type="text/javascript">
						try {
							ace.settings.check('breadcrumbs', 'fixed')
						} catch (e) {
						}
					</script>
					<ul class="breadcrumb">
						<li><i class="ace-icon fa fa-home home-icon"></i> <a href="/dwms/admin">首页</a>
						</li>
						<li><span>库存管理</span></li>
					</ul>
					<!-- /.breadcrumb -->
				</div>
			</div>
			
			<div class="page-content">
				<div class="col-xs-12">
					<div class="table-header">库存管理页面</div>
				
					<div class="row">
						<div class="widget">
						<div class="widget-main">
							<div class="col-sm-8">
								<form id="selefrom" class="form-inline" method="post">
									<input type="search" class="form-control input-sm"
										placeholder="请输入药品名..." aria-controls="dynamic-table" id="iname">
									<input type="search" class="form-control input-sm"
										placeholder="请输入药品批次..." aria-controls="dynamic-table" id="ibatch">
									<input type="search" class="form-control input-sm"
										placeholder="请选择生产日期..." aria-controls="dynamic-table"
									onClick="WdatePicker()" id="idate">

									<a onclick="selectInventory()" class="btn btn-info btn-sm">查询</a>
									<a onclick="reset()" class="btn btn-info btn-sm">重置</a>
								</form>
							</div>
							<div class="pull-right">
								<a href="exportinventoryrexcel" class="btn btn-mini btn-primary" style="width:100px;height:31px">导出库存</a>
								<a href="javascript:addnewInventory()" class="btn btn-mini btn-primary" style="width:100px;height:31px">添加新库存</a>
								<a href="javascript:addInventory()" class="btn btn-mini btn-primary" style="width:100px;height:31px">增加原库存</a>
							</div>
						</div>
						</div>
					</div>
					<br>
					
					<div id="InventoryList" class="row">
						<div class="col-xs-12">
							
							<div class="row">
								<div class="col-xs-12">
									<table class="table table-striped table-bordered table-hover"
										id="tablelsw">
										<!--id="simple-table"  -->
										<thead>
											<tr role="row">
											    <!-- <th><label> <input type="checkbox" class="ace" /> <span class="lbl"></span> </label></th> -->
												<th class="hidden-480"><span>库存序号</span></th>
												<th class="hidden-480"><span>药品名</span></th>
												<th class="hidden-480"><span>药品批次</span></th>
												<th class="hidden-480"><span>库存数量</span></th>
												<th class="hidden-480"><span>生产日期</span></th>
												<th class="hidden-480"><span>失效日期</span></th>
												<th class="hidden-480"><span>备注</span></th>
												<th class="hidden-480"><span>操作</span></th>
											</tr>
										</thead>
										<tbody id="Table_1"> </tbody>
									</table>
									<div id="no3" class="alert alert-info hide">无数据</div>
								</div>
								<!-- /.col -->
							</div>
							 
							 
							<div class="col-xs-12">

								<div class="dataTables_paginate paging_simple_numbers  pull-left">
								<label>每页显示<select name="dynamic-table_length" 
								id="sel1" onchange="chInfNumber()">
										<option value="10">10</option>
										<option value="20">20</option>
										<option value="50">50</option>
										<option value="100">100</option>
								</select>条信息</label>
								</div>
								<div class="dataTables_paginate paging_simple_numbers "
								id="dynamic-table_paginate">
									<ul class="pagination" id="pagefoot1"></ul>
								</div>
							</div>
							   
						</div>
					</div>
					
					
				</div>
			</div>
		</div>
		<!-- /.main-content -->
		<div class="footer">
			<div class="footer-inner">
				<!-- #section:basics/footer -->
				<div class="footer-content">
					<span class="bigger-120"> <span class="red">神农连锁药品仓库管理系统</span>
						&copy;2017 </span> &nbsp; &nbsp;版本：v2017-4-14
				</div>

				<!-- /section:basics/footer -->
			</div>
		</div>

		<a href="#" id="btn-scroll-up"
			class="btn-scroll-up btn btn-sm btn-inverse"> <i
			class="ace-icon fa fa-angle-double-up icon-only bigger-110"></i> </a>
	</div>
	<!-- /.main-container -->
	<!-- basic scripts -->
	<!--[if !IE]> -->
	<script type="text/javascript">
		window.jQuery
				|| document
						.write("<script src='plugins/ace/assets/js/jquery.js'>"
								+ "<"+"/script>");
	</script>

	<!-- <![endif]-->

	<!--[if IE]>
<script type="text/javascript">
 window.jQuery || document.write("<script src='plugins/ace/assets/js/jquery1x.js'>"+"<"+"/script>");
</script>
<![endif]-->
	<script type="text/javascript">
		if ('ontouchstart' in document.documentElement)
			document
					.write("<script src='plugins/ace/assets/js/jquery.mobile.custom.js'>"
							+ "<"+"/script>");
	</script>

	<script src="../plugins/ace/assets/js/bootstrap.js"></script>
	<script src="../plugins/ace/assets/js/jquery-ui.js"></script>
	<script src="../plugins/ace/assets/js/jquery.ui.touch-punch.js"></script>

	<!-- page specific plugin scripts -->
	<script src="../plugins/ace/assets/js/dataTables/jquery.dataTables.js"></script>
	<script
		src="../plugins/ace/assets/js/dataTables/jquery.dataTables.bootstrap.js"></script>
	<script
		src="../plugins/ace/assets/js/dataTables/extensions/TableTools/js/dataTables.tableTools.js"></script>
	<script
		src="../plugins/ace/assets/js/dataTables/extensions/ColVis/js/dataTables.colVis.js"></script>

	<!-- ace scripts -->
	<script src="../plugins/ace/assets/js/ace/elements.scroller.js"></script>
	<script src="../plugins/ace/assets/js/ace/elements.colorpicker.js"></script>
	<script src="../plugins/ace/assets/js/ace/elements.fileinput.js"></script>
	<script src="../plugins/ace/assets/js/ace/elements.typeahead.js"></script>
	<script src="../plugins/ace/assets/js/ace/elements.wysiwyg.js"></script>
	<script src="../plugins/ace/assets/js/ace/elements.spinner.js"></script>
	<script src="../plugins/ace/assets/js/ace/elements.treeview.js"></script>
	<script src="../plugins/ace/assets/js/ace/elements.wizard.js"></script>
	<script src="../plugins/ace/assets/js/ace/elements.aside.js"></script>
	<script src="../plugins/ace/assets/js/ace/ace.js"></script>
	<script src="../plugins/ace/assets/js/ace/ace.ajax-content.js"></script>
	<script src="../plugins/ace/assets/js/ace/ace.touch-drag.js"></script>
	<script src="../plugins/ace/assets/js/ace/ace.sidebar.js"></script>
	<script src="../plugins/ace/assets/js/ace/ace.sidebar-scroll-1.js"></script>
	<script src="../plugins/ace/assets/js/ace/ace.submenu-hover.js"></script>
	<script src="../plugins/ace/assets/js/ace/ace.widget-box.js"></script>
	<script src="../plugins/ace/assets/js/ace/ace.settings.js"></script>
	<script src="../plugins/ace/assets/js/ace/ace.settings-rtl.js"></script>
	<script src="../plugins/ace/assets/js/ace/ace.settings-skin.js"></script>
	<script src="../plugins/ace/assets/js/ace/ace.widget-on-reload.js"></script>
	<script src="../plugins/ace/assets/js/ace/ace.searchbox-autocomplete.js"></script>

	<script src="../plugins/ace/assets/js/jqGrid/jquery.jqGrid.src.js"></script>
	<!-- ~~ -->
	<script src="../plugins/ace/assets/js/jqGrid/i18n/grid.locale-cn.js"></script>
	<!-- ~~ -->

	<script src="../plugins/ace/assets/js/jquery.autosize.js"></script>

	<!-- the following scripts are used in demo only for onpage help and you don't need them -->
	<link rel="stylesheet"href="../plugins/ace/assets/css/ace.onpage-help.css" />
	<script src="../plugins/layer/layer.js"></script>
	<script src="../plugins/layer/extend/layer.ext.js"></script>
	<!-- <script type="text/javascript" src="plugins/layer/extend/layer.ext.js"></script>   -->
	<script type="text/javascript"
		src="../plugins/artDialog/jquery.artDialog.js?skin=twitter"></script>
	<script type="text/javascript"
		src="../plugins/artDialog/plugins/iframeTools.js"></script>

	<script type="text/javascript" src="../plugins/echart/echarts.js"></script>
	<script type="text/javascript"
		src="../plugins/zTree_v3/js/jquery.ztree.core-3.5.js"></script>
	<script type="text/javascript"
		src="../plugins/zTree_v3/js/jquery.ztree.excheck-3.5.js"></script>
	<script type="text/javascript"
		src="../plugins/zTree_v3/js/jquery.ztree.exedit-3.5.js"></script>

	<script type="text/javascript"
		src="../plugins/My97DatePicker/WdatePicker.js"></script>
		<script src="../plugins/ace/assets/js/date-time/bootstrap-datepicker.js"></script>
		<script src="../plugins/ace/assets/js/date-time/bootstrap-timepicker.js"></script>
		<script src="../plugins/ace/assets/js/date-time/moment.js"></script>
		<script src="../plugins/ace/assets/js/date-time/daterangepicker.js"></script>
		<script src="../plugins/ace/assets/js/date-time/bootstrap-datetimepicker.js"></script>
	<script src="../js/jquery-form.js" type="text/javascript"></script>
	<script src="../js/jquery.myLayout.js"></script>
	<script src="../js/jquery.myTree.js"></script>
	
	<!-- 引用js -->
	
	<div class="hide" id="update">
		<form id="pform">
			<div class="form-group">
				<label class="col-sm-3 control-label no-padding-right"
					for="form-field-1">请输入原密码</label>
				<div class="col-sm-9">
					<input type="text" class="form-control" value="" name="ystr" id="str"/>
				</div>
			</div>
			<div class="form-group">
				<label class="col-sm-3 control-label no-padding-right"
					for="form-field-1">请输入新密码</label>
				<div class="col-sm-9">
					<input type="password" class="form-control" name="str" id="str1"
						value="" />
				</div>
			</div>
			<div class="form-group">
				<label class="col-sm-3 control-label no-padding-right"
					for="form-field-1">请再一次输入新密码</label>
				<div class="col-sm-9">
					<input type="password" class="form-control" name="str2" id="str2"
						value="" />
				</div>
			</div>
		</form>
	</div>

	<!-- 显示用户信息 -->
	<div class="hide" id="upcp">
		<form class="form-horizontal" id="uppform" method="post">
			<br> <label
				class="col-sm-12  col-md-12 col-xs-12 col-lg-4  control-label no-padding-right"
				for="form-field-1">用户名</label>
			<div class="col-sm-12 col-md-12 col-xs-12 col-lg-6">
				<input type="text" readonly class="form-control" id="username" />
			</div>
			<label
				class="col-sm-12  col-md-12 col-xs-12 col-lg-4  control-label no-padding-right"
				for="form-field-1">姓名</label>
			<div class="col-sm-12 col-md-12 col-xs-12 col-lg-6">
				<input type="text" readonly class="form-control" id="name" />
			</div>
			<label
				class="col-sm-12  col-md-12 col-xs-12 col-lg-4  control-label no-padding-right"
				for="form-field-1">角色</label>
			<div class="col-sm-12 col-md-12 col-xs-12 col-lg-6">
				<input type="text" readonly class="form-control" id="gender" />
			</div>
		</form>
	</div>

	<script type="text/javascript">
		function updatePerson() {
			document.getElementById("pform").reset();
			$('#update').removeClass("hide");
			userModel = layer.open({
				type : 1,
				shade : [ 0.5 ],
				title : '修改密码', //不显示标题
				area : [ '40%', '250px' ],
				content : $('#update'), //捕获的元素
				btn : [ '确认', '取消' ],
				yes : function(index, layero) { //或者使用btn1
					var str = $("#str").val();
					var str1 = $("#str1").val();
					var str2 = $("#str2").val();
					$.post("mmpd", {"str" : str}, function(data) {
						if (data == 'true') {
							if (str1.length < 6) {								//密码长度的检验
								if(str1 ==""){									//判断是否输入新的密码
									layer.msg("请输入要更该的新密码!");
									return;
								}
								if(str2 ==""){									//判断是否重复输入新密码
									layer.msg("请确认更改的新密码!");
									return;
								}
								layer.msg("密码太短，请重新输入!");
								return;
							}else{
								if(str1 != str2){								//输入的密码是否想通
									layer.msg("请检验两次输入的密码是否相同!");
									return;
								}else{
									$.post("uppass", {"password" : str1}, function(data) {
										if(data=='true')
											layer.msg("密码修改成功!");
										layer.close(index);
										$('#update').addClass("hide");
										layer.confirm('密码修改成功!请重新登录!', {
											btn : [ '确定' ]//按钮
											}, function() {
												window.location.href = "/dwms";
												});
									});
								}
							}
						} else {
							layer.msg("原密码错误!请重新输入.");
							return;
						}
					});
				},
				btn2 : function(index) {
					layer.close(index);
					$('#update').addClass("hide");
					
				},
				cancel : function(index) {
					layer.close(index);
					$('#update').addClass("hide");
					
				}
			});
		};
		function personInfo() {
			$.get("getuser", {
				"num" : 0
			}, function(data) {
				$("#username").val(data.username);
				$("#name").val(data.name);
				$("#gender").val(data.poisition);

				$('#upcp').removeClass("hide");
				userModel = layer.open({
					type : 1,
					shade : [ 0.5 ],
					title : '用户个人信息', //不显示标题
					area : [ '30%', '300px' ], //显示空间
					content : $('#upcp'), //捕获的元素
					btn : [ '确定' ],
					yes : function(index, layero) { //或者使用btn1
						layer.close(index);
						$('#upcp').addClass("hide"); //取消继续隐藏
					},
					cancel : function(index) {
						layer.close(index);
						$('#upcp').addClass("hide");
						
					}
				});

			});
		};
		function signout(){
			//询问框
			layer.confirm('确定是否退出？', {
				btn : [ '确定', '取消' ]
			//按钮
			}, function() {
				$.post("logout",function(data){
					if(data==null){
						//这里写当session中为空或者是非法登陆时候 退出
						layer.confirm('您尚未登录！', {
							btn : [ '确定' ]//按钮
							}, function() {
								window.location.href = "/dwms";
								});
					}
					else{
						window.location.href = "/dwms";
					}
				});
			}, function() {
				layer.msg("已取消");
			});
		};
	</script>
</body>
</html>
<script type="text/javascript">
	$("#signout").click(function() {
		//询问框
		layer.confirm('确定是否退出？', {
			btn : [ '确定', '取消' ]
		//按钮
		}, function() {
			$.post("logout",function(data){
				if(data==null){
					//这里写当session中为空或者是非法登陆时候 退出
					layer.confirm('您尚未登录！', {
						btn : [ '确定' ]//按钮
						}, function() {
							window.location.href = "/dwms";
							});
				}
				else{
					window.location.href = "/dwms";
				}
			});
		}, function() {
			layer.msg("已取消");
		});
	});
	$("#console").click(function() {
		window.location.href = "/dwms/admin";
	});
	$("#flush").click(function() {
		window.location.reload(true);
	});
</script>
	<!-- 重载 -->
	<script type="text/javascript">
							$("#admin_main").click(function(){
								window.location.href="/dwms/admin";
							});
						</script>
	<!-- 跳转 -->
	<script type="text/javascript">
							$("#admin_drug").click(function(){
								window.location.href="/dwms/admin/drug";
							});
		</script>
	<script type="text/javascript">
							$("#admin_inventory").click(function(){
								window.location.href="/dwms/admin/inventory";
							});
		</script>

	<script type="text/javascript">
							$("#admin_inout").click(function(){
								window.location.href="/dwms/admin/inout";
							});
		</script>
	<script type="text/javascript">
							$("#admin_user").click(function(){
								window.location.href="/dwms/admin/user";
							});
		</script>
	<script type="text/javascript">
							$("#admin_log").click(function(){
								window.location.href="/dwms/admin/log";
							});
		</script>
	<script type="text/javascript">
							$("#admin_supplier").click(function(){
								window.location.href="/dwms/admin/supplier";
							});
		</script>
	<script type="text/javascript">
	$.post("getname",function(data){
		if("error"==data){
			//这里写当session中为空或者是非法登陆时候 退出
			layer.confirm('您尚未登录！', {
			btn : [ '确定' ]//按钮
			}, function() {
				window.location.href = "/dwms";
				});
		}
		else{
			if(data.poisition!="管理员"){
				layer.confirm('您当前为非法登录！请重新登录', {
					btn : [ '确定' ]//按钮
					}, function() {
						window.location.href = "/dwms";
						});
			}else{
				$("#login_user").append(data.name);
			}
		}
	});
		</script>

<script type="text/javascript">
$("table").delegate("tr","mouseover",function(){  
    $(this).addClass("tr-mouseover");  
    $(this).css("background-color","#307ecc");   
});   
$("table").delegate("tr","mouseout",function(){  
	$(this).removeClass("tr-mouseover");  
	$(this).css("background-color","#eee");  
}); 

//查询函数
function selectInventory(){
	gArray[0]=document.getElementById("iname").value;
	gArray[1]=document.getElementById("ibatch").value;
	gArray[2]=document.getElementById("idate").value;
	showPage1(1);
}
//查询框重置函数
function reset(){
	document.getElementById("iname").value="";
	document.getElementById("ibatch").value="";
	document.getElementById("idate").value="";
	gArray[0]="";
	gArray[1]="";
	gArray[2]="";
	showPage1(1);
}
//改变每页数据数量的函数
function chInfNumber(){
	var sels=document.getElementById("sel1").childNodes;
	//sels[1].value是10  3  是  20   5是50   7是100
	for(var i=1;i<8;i+=2){
		if(sels[i].selected==true){
			gArray[4]=sels[i].value;
		}
	}
	showPage1(1);
}

//填充表格的函数
function kcgl_trList(data){
		var dataStr="";
		$.each(data, function(i, v) {
			v=data[i];
			dataStr += kcgl_stringBuilder(v,i);
		});
		// 把拼接好的表格内容填充到指定位置
		$("#Table_1").html(dataStr);
}

function kcgl_stringBuilder(v,i) {
	var dataStr = "";
	i=i+1;
	dataStr += '<tr height="30px">';
	dataStr += '<td>' + i + '</td>';
	dataStr += '<td>' + v.name + '</td>';
	dataStr += '<td>' + v.batch + '</td>';
	dataStr += '<td>' + v.number + '</td>';
	dataStr += '<td>' + v.product_date + '</td>';
	dataStr += '<td>' + v.expiry_date + '</td>';
	if(v.note==null){
		dataStr += '<td>' +"无"+ '</td>';
	}else{
		dataStr += '<td>' + v.note + '</td>';
	}
	dataStr += '<td><div class="hidden-sm hidden-xs action-buttons"><a href="javascript:Delete('+
	v.id+')" class="red"> <i class="ace-icon fa fa-trash-o bigger-130"></i> </a></div></td>';
	dataStr += '</tr>';		
	return dataStr;
}
function Delete(id){
	if(id!=null){
		layer.confirm('是否确定删除此药品的库存？', {btn : [ '确定', '取消' ]}, function() {
		$.post("deleteInventory",{"id":id}, function(data) {
			if(data=="success"){
				layer.msg("已删除");
				showPage1(gArray[3]);
			}else{
				errorMsg("该商品库存尚未清空，无法删除！");
				showPage1(gArray[3]);
			}
		});
	}, function() {
		layer.msg("已取消");
	});
		}else{
			layer.alert("请选择要删除的数据！");
		}
	
}
function addnewInventory(){
	document.getElementById("addForm2").reset();
	$('#addnewInventory').removeClass("hide");
	document.getElementById("n.date1").value=getNowFormatDate();
	userModel = layer.open({
					type : 1,
					shade : [ 0.5 ],
					title : '添加新库存', //不显示标题
					area : [ '40%', '60%' ], //显示空间
					content : $('#addnewInventory'), //捕获的元素
					btn : [ '确认', '取消' ],
					yes : function(index, layero) { //或者使用btn1
						var name = document.getElementById("n.name").value;
						var batch = document.getElementById("n.batch").value;
						var number = document.getElementById("n.number").value;
						var date1 = document.getElementById("n.date1").value;
						var date2 = document.getElementById("n.date2").value;
						var date3 = document.getElementById("n.date3").value;
						var note = document.getElementById("n.note").value;
						var iArray = new Array(name,batch,number,date1,date2,date3,note);
						if(name=="" ){
							errorMsg("请选择药品");
							return false;
						}else if(name.indexOf(" ")>=0){
							errorMsg("药品名不能含有空格(每条信息都不可以有)");
							return false;
						}

						if(batch==""){
							errorMsg("请选择药品");
							return false;
						}else if(number.indexOf(' ')>=0){
							errorMsg("药品批次不能含有空格(每条信息都不可以有)");
							return false;
						}

						if(number==""){
							errorMsg("入库数量不能为空");
							return false;
						}
						
						var d1 = new Date(date2.replace(/\-/g, "\/")); 
						var d2 = new Date(date3.replace(/\-/g, "\/")); 
						
						if(date2 == "" || date3 ==""){
							errorMsg("生产日期和失效日期均不能为空");
						}else if(date2!=""&&date3!=""&&d1 >=d2) { 
							errorMsg("生产日期不能大于失效日期！"); 
						    return false; 
						}
						$.post("addnewInventory",{"iArray[]":iArray}, function(data) {
							if(data=="success"){
								layer.close(index);
								$('#addnewInventory').addClass("hide");
								showPage1(gArray[3]);
								layer.msg("添加成功");
							}else{
								layer.close(index);
								$('#addnewInventory').addClass("hide");
								errorMsg("该库存已存在,请选择增加原库存!"); 
							}
						});
					
					},
					btn2   : function(index) {
								layer.close(index);
								$('#addnewInventory').addClass("hide"); //取消继续隐藏
								layer.msg("已取消");
					},
					cancel : function(index) {
								layer.close(index);
								$('#addnewInventory').addClass("hide"); //取消继续隐藏
								layer.msg("已取消");
							}
					});
	
	
}

function addInventory(){
	document.getElementById("addForm").reset();
	$('#addInventory').removeClass("hide");
	document.getElementById("a.date").value=getNowFormatDate();
	userModel = layer.open({
					type : 1,
					shade : [ 0.5 ],
					title : '增加原库存', //不显示标题
					area : [ '40%', '40%' ], //显示空间
					content : $('#addInventory'), //捕获的元素
					btn : [ '确认', '取消' ],
					yes : function(index, layero) { //或者使用btn1
						var name = document.getElementById("a.name").value;
						var batch = document.getElementById("a.batch").value;
						var number = document.getElementById("a.number").value;
						var date = document.getElementById("a.date").value;
						var iArray = new Array(name,batch,number,date);
						if(name=="" ){
							errorMsg("请选择药品");
							return false;
						}else if(name.indexOf(" ")>=0){
							errorMsg("药品名不能含有空格(每条信息都不可以有)");
							return false;
						}

						if(batch==""){
							errorMsg("请选择药品");
							return false;
						}else if(number.indexOf(' ')>=0){
							errorMsg("药品批次不能含有空格(每条信息都不可以有)");
							return false;
						}

						if(number==""){
								errorMsg("增加数量不能为空");
								return false;
							}

		
						$.post("addInventory",{"iArray[]":iArray}, function(data) {
							if(data=="success"){
								layer.close(index);
								$('#addInventory').addClass("hide");
								showPage1(gArray[3]);
								layer.msg("增加成功");
							}else{
								layer.close(index);
								$('#addInventory').addClass("hide");
								errorMsg("该库存不存在，请选择添加新库存！");
							}
						});
					
					},
					btn2   : function(index) {
								layer.close(index);
								$('#addInventory').addClass("hide"); //取消继续隐藏
								layer.msg("已取消");
					},
					cancel : function(index) {
								layer.close(index);
								$('#addInventory').addClass("hide"); //取消继续隐藏
								layer.msg("已取消");
							}
					});
	
}

//页脚填充函数
function PageFoot1(data){
	var dataStr = "";
	if(data.pageNumber==1)
	{
		dataStr +='<li class="paginate_button previous disabled" ';
		dataStr +='aria-controls="dynamic-table" tabindex="0">';
		dataStr +='<a>首页</a></li>';
		dataStr +='<li class="paginate_button previous disabled" ';
		dataStr +='aria-controls="dynamic-table" tabindex="0">';
		dataStr +='<a>上一页</a></li>';
	}else
	{
		dataStr +='<li class="paginate_button previous" aria-controls="dynamic-table" tabindex="0"';
		dataStr +='id="dynamic-table_previous"><a href="javascript:showPage1(1)">首页</a></li>';
		dataStr +='<li class="paginate_button previous" aria-controls="dynamic-table" tabindex="0"';
		dataStr +='id="dynamic-table_previous"><a href="javascript:showPage1('+data.pageNumber+'-1)">上一页</a></li>';
	}
	
	if(data.pageNumber<4){
		for(var i = 1;i<=data.totalPage;i++){
			if(data.pageNumber==i){
				dataStr += "<li class=\"paginate_button active\"tabindex=\"0\">";
				dataStr += "<a>"+i+"</a></li>";
			}else{
				dataStr += "<li class=\"paginate_button\"tabindex=\"0\">";
				dataStr += "<a href=\"javascript:showPage1("+i+")\">"+i+"</a></li>";
			}
			if(i==5){
				break;
			}
		}
		if(data.totalPage>5){
			dataStr +="<li class=\"paginate_button previous disabled\" tabindex=\"0\"><a>...</a></li>";
		}
	}else if(data.pageNumber>(data.totalPage-3)){
		if(data.totalPage<6){
			for(var i = 1;i<=data.totalPage;i++){
				if(data.pageNumber==i){
					dataStr += "<li class=\"paginate_button active\"tabindex=\"0\">";
					dataStr += "<a>"+i+"</a></li>";
				}else{
					dataStr += "<li class=\"paginate_button\"tabindex=\"0\">";
					dataStr += "<a href=\"javascript:showPage1("+i+")\">"+i+"</a></li>";
				}
			}
		}else{
			dataStr +="<li class=\"paginate_button previous disabled\" tabindex=\"0\"><a>...</a></li>";			
			for(var i = data.totalPage-4;i<=data.totalPage;i++){
				if(data.pageNumber==i){
					dataStr += "<li class=\"paginate_button active\"tabindex=\"0\">";
					dataStr += "<a>"+i+"</a></li>";
				}else{
					dataStr += "<li class=\"paginate_button\"tabindex=\"0\">";
					dataStr += "<a href=\"javascript:showPage1("+i+")\">"+i+"</a></li>";
				}
			}
		}
	}else{
		dataStr +="<li class=\"paginate_button previous disabled\" tabindex=\"0\"><a>...</a></li>";
		for(var i = data.pageNumber-2;i<data.pageNumber+3;i++){
			if(data.pageNumber==i){
				dataStr += "<li class=\"paginate_button active\"tabindex=\"0\">";
				dataStr += "<a>"+i+"</a></li>";
			}else{
				dataStr += "<li class=\"paginate_button\"tabindex=\"0\">";
				dataStr += "<a href=\"javascript:showPage1("+i+")\">"+i+"</a></li>";
			}
		}
		dataStr +="<li class=\"paginate_button previous disabled\" tabindex=\"0\"><a>...</a></li>";
	}
	if(data.totalPage==data.pageNumber){
		dataStr +='<li class="paginate_button next disabled" aria-controls="dynamic-table" tabindex="0">';
		dataStr +='<a>下一页</a></li>';
		dataStr +='<li class="paginate_button next disabled" aria-controls="dynamic-table" tabindex="0">';
		dataStr +='<a>尾页</a></li>';
	}else{
		dataStr +='<li class="paginate_button next" aria-controls="dynamic-table" tabindex="0">';
		dataStr +='<a href="javascript:showPage1('+data.pageNumber+'+1)">下一页</a></li>';
		dataStr +='<li class="paginate_button next" aria-controls="dynamic-table" tabindex="0">';
		dataStr +='<a href="javascript:showPage1('+data.totalPage+')">尾页</a></li>';
	}
	$("#pagefoot1").html(dataStr);		 //把循环好的页码给替换掉
};

var gArray = new Array("","","",1,10);
function showPage1(curr) { 
	gArray[3] = curr;
	$.post("inventorylist", {"gArray[]": gArray}, function(data) {
		if(data.totalPage==0){
			$('#no3').removeClass("hide");
			$('#tablelsw').addClass("hide");
		}else{
			$('#no3').addClass("hide");
			$('#tablelsw').removeClass("hide");
			kcgl_trList(data.list);
			PageFoot1(data); 		   //调用的PageFoot方法，循环输出页码连接  
		}
	});
}
showPage1(1);   		//刚进入页面为第一页，列出第一页数据和页脚
</script>
<!--添加新库存  -->
	<div class="hide" id="addnewInventory">
		<div class="col-xs-1"></div>
		<div class="col-xs-10">

			<form method="post"  id="addForm2">
				<input type="text" name="n.registrar" type="hidden" id="n.registrar"
					class="hide">
				<div class="form-group"><br>
					<a href="javascript:selectDrug()" class="col-sm-2 btn btn-sm btn-info" style="height:32px">选择药品</a><br><br>
				</div>

				<div class="form-group">
					<label class="col-sm-2 control-label no-padding-right"
						for="form-field-1">药品名:</label>
					<div class="col-sm-4">
						<input type="text"  placeholder="必填" readonly="readonly" class="form-control"
						 name="n.name" id="n.name" value="" /><br>
					</div>
					<label class="col-sm-2 control-label no-padding-right"
						for="form-field-1">药品批次:</label>
					<div class="col-sm-4">
						<input type="text"  placeholder="必填" readonly="readonly" class="form-control"
						 name="n.batch" id="n.batch" value="" /><br>
					</div>
				</div>
				
				<div class="form-group">
					<label class="col-sm-2 control-label no-padding-right"
						for="form-field-1">入库数量:</label>
					<div class="col-sm-4">
						<input type="text" class="form-control" ONBLUR="javascript:newnum()" name="n.number"
							id="n.number"  placeholder="必填" value="" /><br>
					</div>
					<label class="col-sm-2 control-label no-padding-right"
						for="form-field-1">入库时间:</label>
					<div class="col-sm-4">
						<input type="text" class="form-control" readonly="" name="n.date1"
							id="n.date1"  placeholder="必填" value="" /><br>
					</div>
				</div>
				
				<div class="form-group">
					<label class="col-sm-2 control-label no-padding-right"
						for="form-field-1">生产日期:</label>
					<div class="col-sm-4">
						<input type="text" class="form-control" onClick="WdatePicker()"name="n.date2"
							id="n.date2"  placeholder="必填" value="" /><br>
					</div>
					<label class="col-sm-2 control-label no-padding-right"
						for="form-field-1">失效日期:</label>
					<div class="col-sm-4">
						<input type="text" class="form-control"onClick="WdatePicker()"  name="n.date3"
							id="n.date3"  placeholder="必填" value="" /><br>
					</div>
				</div>
				<div class="form-group">
					<label class="col-sm-2 control-label no-padding-right"
						for="form-field-1" >备注:</label>
					<div class="col-sm-10"><br>
						<textarea style="height:100px;width:" class="form-control"
							name="n.note"  id="n.note"></textarea>
					</div>
				</div>
				
			</form>
		</div>
	</div>
<!--增加库存  -->
	<div class="hide" id="addInventory">
		<div class="col-xs-1"></div>
		<div class="col-xs-10">

			<form method="post"  id="addForm">
				<input type="text" name="a.registrar" type="hidden" id="a.registrar"
					class="hide">
				<div class="form-group"><br>
					<a href="javascript:selectDrug()" class="col-sm-2 btn btn-sm btn-info" style="height:32px">选择药品</a><br><br>
				</div>

				<div class="form-group">
					<label class="col-sm-2 control-label no-padding-right"
						for="form-field-1">药品名:</label>
					<div class="col-sm-4">
						<input type="text"  placeholder="必填" readonly="readonly" class="form-control"
						 name="a.name" id="a.name" value="" /><br>
					</div>
					<label class="col-sm-2 control-label no-padding-right"
						for="form-field-1">药品批次:</label>
					<div class="col-sm-4">
						<input type="text"  placeholder="必填" readonly="readonly" class="form-control"
						 name="a.batch" id="a.batch" value="" /><br>
					</div>
				</div>
				
				<div class="form-group">
					<label class="col-sm-2 control-label no-padding-right"
						for="form-field-1">增加数量:</label>
					<div class="col-sm-4">
						<input type="text" ONBLUR="javascript:addnum()" class="form-control" name="a.number"
							id="a.number"  placeholder="必填" value="" /><br>
					</div>
					<label class="col-sm-2 control-label no-padding-right"
						for="form-field-1">入库时间:</label>
					<div class="col-sm-4">
						<input type="text" class="form-control" readonly="" name="a.date"
							id="a.date"  placeholder="必填" value="" /><br>
					</div>
				</div>
			</form>
		</div>
	</div>
<div class="hide" id="selectDrug">
		<div class="table-header">选择要增加库存的药品</div><br>
		<div class="row">
			<div class="col-sm-10">
				<form id="selefrom" class="form-inline" action="rzcksele" method="post">　　　
					<input type="search" class="form-control input-sm"
					placeholder="请输入药品名.." aria-controls="dynamic-table" id="dname">
					<a onclick="selectd()" class="btn btn-info btn-sm">查询</a>
				</form>
			</div>
		</div>		<br>									
		<div id="druglist" class="row">
			<div class="col-xs-12">
				<div class="row">
					<div class="col-xs-12">
						<table class="table table-striped table-bordered table-hover"
							id="table3">
							<!--id="simple-table"  -->
							<thead>
							<tr role="row">
						 	<!-- <th><label> <input type="checkbox" class="ace" /> <span class="lbl"></span> </label></th> -->
							<th class="hidden-480"><span>药品名</span></th>
							<th class="hidden-480"><span>药品批次</span></th>
							</tr>
							</thead>
							<tbody id="Table_2"> </tbody>
						</table>

					</div>
					<!-- /.col -->
				</div>
			
							   
			</div>
			<div class="col-xs-12 ">
				<div class="dataTables_paginate paging_simple_numbers "
					id="dynamic-table_paginate">
					<ul class="pagination" id="pagefoot2"></ul>
				</div>
			</div>
		</div>
		
</div>
<script type="text/javascript">
$("table").delegate("tr","mouseover",function(){  
    $(this).addClass("tr-mouseover");  
    $(this).css("background-color","#307ecc");   
});   
$("table").delegate("tr","mouseout",function(){  
	$(this).removeClass("tr-mouseover");  
	$(this).css("background-color","#eee");  
});
function selectd(){
	dArray[0]=document.getElementById("dname").value;
	showPage2(1);
}

var druglist="";
function selectDrug(){
	$('#dname').val("");
	dArray[0]="";
	showPage2(1);
	$('#selectDrug').removeClass("hide");
	druglist = layer.open({
		type : 1,
		shade : [ 0.5 ],
		title : '选择药品', //不显示标题
		area : [ '50%', '75%' ], //显示空间
		content : $('#selectDrug'), //捕获的元素
		btn : [ '取消' ],
		btn1 : function(index, layero) { //或者使用btn1
					layer.close(index);
					$('#selectDrug').addClass("hide"); //取消继续隐藏
					layer.msg("已取消");
		
		},
		cancel : function(index) {
					layer.close(index);
					$('#selectDrug').addClass("hide"); //取消继续隐藏
					layer.msg("已取消");
				}
		});

}
function selectOk(name,batch){
	document.getElementById("a.name").value=name;
	document.getElementById("a.batch").value=batch;
	document.getElementById("n.name").value=name;
	document.getElementById("n.batch").value=batch;
	layer.close(druglist);
	$('#selectDrug').addClass("hide");
}
//填充表格的函数
function d_trList(data){
	var dataStr="";
	$.each(data, function(i, v) {
		v=data[i];
		dataStr += d_stringBuilder(v,i);
	});
	// 把拼接好的表格内容填充到指定位置
	$("#Table_2").html(dataStr);
}

function d_stringBuilder(v,i){
	var dataStr="";
	dataStr += '<tr onclick="selectOk(\''+v.name+'\',\''+v.batch+'\')">';
	dataStr += '<td>'+ v.name+'</td>';
	dataStr += '<td>'+ v.batch +'</td>';
	dataStr += '</tr>';
	return dataStr;
}
//页脚填充函数
function PageFoot2(data){
	var dataStr = "";
	if(data.pageNumber==1)
	{
		dataStr +='<li class="paginate_button previous disabled" ';
		dataStr +='aria-controls="dynamic-table" tabindex="0">';
		dataStr +='<a>首页</a></li>';
		dataStr +='<li class="paginate_button previous disabled" ';
		dataStr +='aria-controls="dynamic-table" tabindex="0">';
		dataStr +='<a>上一页</a></li>';
	}else
	{
		dataStr +='<li class="paginate_button previous" aria-controls="dynamic-table" tabindex="0"';
		dataStr +='id="dynamic-table_previous"><a href="javascript:showPage2(1)">首页</a></li>';
		dataStr +='<li class="paginate_button previous" aria-controls="dynamic-table" tabindex="0"';
		dataStr +='id="dynamic-table_previous"><a href="javascript:showPage2('+data.pageNumber+'-1)">上一页</a></li>';
	}
	
	if(data.pageNumber<4){
		for(var i = 1;i<=data.totalPage;i++){
			if(data.pageNumber==i){
				dataStr += "<li class=\"paginate_button active\"tabindex=\"0\">";
				dataStr += "<a>"+i+"</a></li>";
			}else{
				dataStr += "<li class=\"paginate_button\"tabindex=\"0\">";
				dataStr += "<a href=\"javascript:showPage2("+i+")\">"+i+"</a></li>";
			}
			if(i==5){
				break;
			}
		}
		if(data.totalPage>5){
			dataStr +="<li class=\"paginate_button previous disabled\" tabindex=\"0\"><a>...</a></li>";
		}
	}else if(data.pageNumber>(data.totalPage-3)){
		if(data.totalPage<6){
			for(var i = 1;i<=data.totalPage;i++){
				if(data.pageNumber==i){
					dataStr += "<li class=\"paginate_button active\"tabindex=\"0\">";
					dataStr += "<a>"+i+"</a></li>";
				}else{
					dataStr += "<li class=\"paginate_button\"tabindex=\"0\">";
					dataStr += "<a href=\"javascript:showPage2("+i+")\">"+i+"</a></li>";
				}
			}
		}else{
			dataStr +="<li class=\"paginate_button previous disabled\" tabindex=\"0\"><a>...</a></li>";			
			for(var i = data.totalPage-4;i<=data.totalPage;i++){
				if(data.pageNumber==i){
					dataStr += "<li class=\"paginate_button active\"tabindex=\"0\">";
					dataStr += "<a>"+i+"</a></li>";
				}else{
					dataStr += "<li class=\"paginate_button\"tabindex=\"0\">";
					dataStr += "<a href=\"javascript:showPage2("+i+")\">"+i+"</a></li>";
				}
			}
		}
	}else{
		dataStr +="<li class=\"paginate_button previous disabled\" tabindex=\"0\"><a>...</a></li>";
		for(var i = data.pageNumber-2;i<data.pageNumber+3;i++){
			if(data.pageNumber==i){
				dataStr += "<li class=\"paginate_button active\"tabindex=\"0\">";
				dataStr += "<a>"+i+"</a></li>";
			}else{
				dataStr += "<li class=\"paginate_button\"tabindex=\"0\">";
				dataStr += "<a href=\"javascript:showPage2("+i+")\">"+i+"</a></li>";
			}
		}
		dataStr +="<li class=\"paginate_button previous disabled\" tabindex=\"0\"><a>...</a></li>";
	}
	if(data.totalPage==data.pageNumber){
		dataStr +='<li class="paginate_button next disabled" aria-controls="dynamic-table" tabindex="0">';
		dataStr +='<a>下一页</a></li>';
		dataStr +='<li class="paginate_button next disabled" aria-controls="dynamic-table" tabindex="0">';
		dataStr +='<a>尾页</a></li>';
	}else{
		dataStr +='<li class="paginate_button next" aria-controls="dynamic-table" tabindex="0">';
		dataStr +='<a href="javascript:showPage2('+data.pageNumber+'+1)">下一页</a></li>';
		dataStr +='<li class="paginate_button next" aria-controls="dynamic-table" tabindex="0">';
		dataStr +='<a href="javascript:showPage2('+data.totalPage+')">尾页</a></li>';
	}
	
	$("#pagefoot2").html(dataStr);		 //把循环好的页码给替换掉
};
var dArray= new Array();
function showPage2(curr) {  
	dArray[1] = curr;
	$.post("dlist",{"dArray[]":dArray},function(data){
		d_trList(data.list);
		PageFoot2(data); 		   //调用的PageFoot方法，循环输出页码连接  
	});
}

//错误信息提示
function errorMsg(errorInfo) {
		layer.confirm(errorInfo, {
			title: '提示信息',
			btn : [ '确定' ]
		//按钮
		}, function(index) {
			layer.close(index);
		});
	}
function getNowFormatDate() {
    var date = new Date();
    var seperator1 = "-";
    var seperator2 = ":";
    var year = date.getFullYear();
    var month = date.getMonth() + 1;
    var strDate = date.getDate();
    if (month >= 1 && month <= 9) {
        month = "0" + month;
    }
    if (strDate >= 0 && strDate <= 9) {
        strDate = "0" + strDate;
    }
    var currentdate = year + seperator1 + month + seperator1 + strDate
            + " " + date.getHours() + seperator2 + date.getMinutes()
            + seperator2 + date.getSeconds();
    return currentdate;
}

function newnum(){
	var num = document.getElementById("n.number").value;
	if (num == "") {
		errorMsg("订货数量不能为空");
		return false;
	} else if (num.indexOf(" ") >= 0) {
		errorMsg("订货数量不能含有空格(每条信息都不可以有)");
		document.getElementById("n.number").value = "";
		return false;
	} else if (IsNum(num) == false) {
		errorMsg("订货数量只能为正整数");
		document.getElementById("n.number").value = "";
		return false;
	}
}

function addnum(){
	var num = document.getElementById("a.number").value;
	if (num == "") {
		errorMsg("订货数量不能为空");
		return false;
	} else if (num.indexOf(" ") >= 0) {
		errorMsg("订货数量不能含有空格(每条信息都不可以有)");
		document.getElementById("a.number").value = "";
		return false;
	} else if (IsNum(num) == false) {
		errorMsg("订货数量只能为正整数");
		document.getElementById("a.number").value = "";
		return false;
	}
}

function IsNum(num) {
	var reNum = /^[0-9]*[1-9][0-9]*$/;
	return (reNum.test(num));
}
</script>

